{"version":3,"file":"component---src-templates-page-js-07647b86769ff77ae3f4.js","mappings":"4RAUqBA,EAAY,SAAAC,GAAA,SAAAD,IAAA,QAAAE,EAAAC,EAAAC,UAAAC,OAAAC,EAAA,IAAAC,MAAAJ,GAAAK,EAAA,EAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAmC9B,OAnC8BN,EAAAD,EAAAQ,KAAAC,MAAAT,EAAA,OAAAU,OAAAL,KAAA,MAC/BM,MAAQ,CACNC,MAAO,CACJC,QAASZ,EAAKa,MAAMC,KAAKH,MAAQI,KAAKC,MAAMhB,EAAKa,MAAMC,KAAKH,MAAMC,SAAW,CAAC,EAC9EK,aAAc,MAEjBC,iBAAkB,YACnBlB,EAiBDmB,eAAiB,WACf,OAAOC,EAAAA,EAAAA,GAAU,eACnB,EAACpB,EAEDqB,eAAiB,SAACC,IAChBC,EAAAA,EAAAA,GAAU,gBAAgBD,GAC1BtB,EAAKwB,SAAS,CAAEP,aAAcK,GAChC,EAACtB,EAEDyB,mBAAqB,SAACC,GACpB1B,EAAKwB,SAAS,CAAEN,iBAAkBQ,GACpC,EAAC1B,CAAA,EAnC8B2B,EAAAA,EAAAA,GAAA7B,EAAAC,GAmC9B,IAAA6B,EAAA9B,EAAA+B,UA0BA,OA1BAD,EA1BKE,gBAAe,eAAAC,GAAAC,EAAAA,EAAAA,GAAAC,IAAAA,MAArB,SAAAC,IAAA,IAAAC,EAAAxB,EAAA,OAAAsB,IAAAA,MAAA,SAAAG,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,OACuD,OAArDC,EAAAA,EAAiBC,SAASC,KAAK5B,MAAM6B,SAASC,QAAOP,EAAAE,KAAA,EACrBC,EAAAA,EAAiBK,IAAI,eAAeH,KAAK5B,MAAMC,KAAKH,MAAMkC,WAAY,OAAnF,OAAmFV,EAAAC,EAAAU,KAAxFnC,EAAKwB,EAAbrB,KAAQH,MAAKyB,EAAAW,OAAA,SACZpC,GAAK,wBAAAyB,EAAAY,OAAA,GAAAd,EAAA,UACb,yBAAAH,EAAAvB,MAAA,KAAAN,UAAA,EAJoB,GAIpB0B,EAEKqB,kBAAiB,eAAAC,GAAAlB,EAAAA,EAAAA,GAAAC,IAAAA,MAAvB,SAAAkB,IAAA,IAAAxC,EAAAyC,EAAA,YAAAnB,IAAAA,MAAA,SAAAoB,GAAA,cAAAA,EAAAhB,KAAAgB,EAAAf,MAAA,cAAAe,EAAAf,KAAA,EACoBG,KAAKX,kBAAiB,QAApCnB,EAAK0C,EAAAP,MACAlC,SAAS6B,KAAKjB,SAAS,CAAEb,MAAAA,IAClC2C,YAAW,kBAAMf,EAAAA,EAAiBgB,WAAWH,EAAK,GAAE,KAChDX,KAAKtB,kBACPsB,KAAKpB,eAAeoB,KAAKtB,kBAC1B,wBAAAkC,EAAAL,OAAA,GAAAG,EAAA,UACF,yBAAAD,EAAA1C,MAAA,KAAAN,UAAA,EAPsB,GAOtB0B,EAeD4B,OAAA,WACE,OACEC,EAAAA,cAACC,EAAAA,EAAYC,SAAQ,CACnBrC,MAAO,CACLsC,YAAanB,KAAK/B,MAAMC,MAAMkD,KAC9BnB,SAAUD,KAAK5B,MAAM6B,SACrBoB,KAAMrB,KAAK/B,MAAMC,MAAMmD,KACvBC,mBAAoBtB,KAAK/B,MAAMC,MAAMoD,mBACrCnD,QAAS6B,KAAK/B,MAAMC,MAAMC,QAC1BoD,SAAUvB,KAAK/B,MAAMC,MAAMqD,SAC3B3C,eAAgBoB,KAAKpB,eACrB4C,YAAaxB,KAAK/B,MAAMO,aACxBC,iBAAkBuB,KAAK/B,MAAMQ,iBAC7BO,mBAAoBgB,KAAKhB,qBAG3BgC,EAAAA,cAACS,EAAAA,EAAM,CAACxB,SAAUD,KAAK5B,MAAM6B,UACa,eAAvCD,KAAK/B,MAAMC,MAAMC,QAAQuD,WACxBV,EAAAA,cAACW,EAAAA,EAAc,MAEjBX,EAAAA,cAACY,EAAAA,EAAI,CAACC,KAAM7B,KAAK/B,MAAMC,MAAMC,WAIrC,EAACd,CAAA,CA7D8B,CAAS2D,EAAAA,U","sources":["webpack://andys-man-club/./src/templates/page.js"],"sourcesContent":["import React from \"react\"\nimport Page from '../components/Page'\nimport Layout from \"../components/Layout\"\nimport { graphql } from 'gatsby'\nimport StoryblokService from '../utils/storyblok-service'\nimport { PageContext } from \"src/utils/context\";\nimport ContentHeading from \"src/components/ContentHeading\"\nimport SetCookie from \"src/utils/SetCookie\";\nimport GetCookie from \"src/utils/GetCookie\";\n \nexport default class PageTemplate extends React.Component {\n  state = {\n    story: {\n       content: this.props.data.story ? JSON.parse(this.props.data.story.content) : {},\n       cta_referrer: null,\n    },\n    background_color: \"bg-white\"\n  }\n \n  async getInitialStory() {\n    StoryblokService.setQuery(this.props.location.search)\n    let { data: { story } } = await StoryblokService.get(`cdn/stories/${this.props.data.story.full_slug}`)\n    return story\n  }\n \n  async componentDidMount() {\n    let story = await this.getInitialStory()\n    if(story.content) this.setState({ story })\n    setTimeout(() => StoryblokService.initEditor(this), 200)\n    if( this.getCtaReferrer() ) {\n      this.setCtaReferrer(this.getCtaReferrer())\n    } \n  }\n\n  getCtaReferrer = () => {\n    return GetCookie(\"cta_referrer\");\n  }  \n\n  setCtaReferrer = (value) => {\n    SetCookie(`cta_referrer=${value}`)\n    this.setState({ cta_referrer: value })\n  }\n \n  setBackgroundColor = (color) => {\n    this.setState({ background_color: color })\n  }\n\n  render() {\n    return (\n      <PageContext.Provider\n        value={{\n          currentPage: this.state.story.uuid,\n          location: this.props.location,\n          name: this.state.story.name,\n          first_published_at: this.state.story.first_published_at,\n          content: this.state.story.content,\n          tag_list: this.state.story.tag_list,\n          setCtaReferrer: this.setCtaReferrer,\n          ctaReferrer: this.state.cta_referrer,\n          background_color: this.state.background_color,\n          setBackgroundColor: this.setBackgroundColor,          \n        }}\n      >\n        <Layout location={this.props.location}>\n          {this.state.story.content.component === 'news_views' &&\n            <ContentHeading/>\n          }\n          <Page blok={this.state.story.content} />\n        </Layout>\n      </PageContext.Provider>\n    )\n  }\n}\n\n \nexport const query = graphql`\n  query storyBySlug($fullSlug: String!) {\n    story: storyblokEntry(full_slug: { eq: $fullSlug }) {\n      name\n      content\n      full_slug\n      uuid\n    }\n  }\n`"],"names":["PageTemplate","_React$Component","_this","_len","arguments","length","args","Array","_key","call","apply","concat","state","story","content","props","data","JSON","parse","cta_referrer","background_color","getCtaReferrer","GetCookie","setCtaReferrer","value","SetCookie","setState","setBackgroundColor","color","_inheritsLoose","_proto","prototype","getInitialStory","_getInitialStory","_asyncToGenerator","_regeneratorRuntime","_callee","_yield$StoryblokServi","_context","prev","next","StoryblokService","setQuery","this","location","search","get","full_slug","sent","abrupt","stop","componentDidMount","_componentDidMount","_callee2","_this2","_context2","setTimeout","initEditor","render","React","PageContext","Provider","currentPage","uuid","name","first_published_at","tag_list","ctaReferrer","Layout","component","ContentHeading","Page","blok"],"sourceRoot":""}